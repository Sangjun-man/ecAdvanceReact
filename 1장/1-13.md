# 13. 배열에 항목 추가하기

`input` 2개와 `button` 1개로 이루어진 컴포넌트

### CreateUser.js

```jsx
import React from 'react';

const CreateUser = ({ username, email, onChange, onCreate }) => {
    return (
        <div>
            <input
                name="username"
                placeholder="계정명"
                onChange={onChange}
                value={username}
            />
            <input
                name="email"
                placeholder="이메일"
                onChange={onChange}
                value={email}
            />
            <button onClick={onCreate}>등록</button>
        </div>
    );
}

export default CreateUser;
```

상태관리를 `CreateUser`에서 하지 않고 부모 컴포넌트인 App 에서 할 것이다.

`input`의 값 및 이벤트로 등록할 함수들을 `props`로 넘겨 받아서 사용한다.

`App.js`에서 `CreateUser` 컴포넌트로 넘겨줄 props를 만들어 보자.

### App.js

```jsx
import React, { useState, useRef } from 'react';
import CreateUser from './CreateUser';
import UserList from './UserList';

const App = () => {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = e => {
    const { value, name } = e.target;
    setInputs({
      ...inputs,
      [name]: value
    });
  };
  const users = [
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com'
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com'
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com'
    }
  ];
  const nextId = useRef(4);
  const onCreate = () => {
		// users 배열에 input에 입력한 이름과 이메일을 등록할 코드 작성

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  };
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} />
    </>
  )
}

export default App;
```

`users` 배열에 이름과 이메일을 추가하기 위해서 `useState()` 로 상태를 관리해보자.

그리고 `onCreate` 함수를 통해 입력받은 이름과 이메일을 `useRef()`로 관리한 `nextId`의 값과 함께 `users`배열에 넣을 것이다.

### CreateUser.js

```jsx
import React, { useState, useRef } from 'react';
import CreateUser from './CreateUser';
import UserList from './UserList';

const App = () => {
  const [inputs, setInputs] = useState({
    username: '',
    email: ''
  });
  const { username, email } = inputs;
  const onChange = e => {
    const { value, name } = e.target;
    setInputs({
      ...inputs,
      [name]: value
    });
  };
  const [users, setUsers] = useState([
    {
      id: 1,
      username: 'velopert',
      email: 'public.velopert@gmail.com'
    },
    {
      id: 2,
      username: 'tester',
      email: 'tester@example.com'
    },
    {
      id: 3,
      username: 'liz',
      email: 'liz@example.com'
    }
  ]);
  const nextId = useRef(4);
  const onCreate = () => {
    const user = {
      id: nextId.current,
      username,
      email
    };
		// 불변성을 지켜주기 위해 
    setUsers([...users, user]);

    setInputs({
      username: '',
      email: ''
    });
    nextId.current += 1;
  };
  return (
    <>
      <CreateUser
        username={username}
        email={email}
        onChange={onChange}
        onCreate={onCreate}
      />
      <UserList users={users} />
    </>
  )
}

export default App;
```

위 코드에서 `users` 배열에 변화를 줄 때, 객체와 마찬가지로 불변성을 지켜주어야 한다. 

그렇기 때문에, 배열의 `push`, `splice`, `sort` 등의 함수를 사용하면 안되고, 기존 배열을 `spread` 연산자로 복사한 후 새로운 배열에 내용을 추가한다.

또 불변성을 지키는 다른 방법은 `concat` 함수를 사용하는 것이다. `concat` 함수는 기존의 배열을 수정하지 않고, 새로운 원소가 추가된 **새로운 배열**을 만들어 준다.

```jsx
setUsers([...users, user]);
// 아래와 같이 작성해도 무방하다.
setUsers(users.concat(user));
```

### 질문

배열에 새 항목을 추가할 때 어떤 방법이 있고, 왜 그렇게 하는가?

- 기존의 배열을 spread 연산자로 복사한 후 새로운 배열에 새 항목을 추가한다.
- concat 함수를 사용하여 기존의 배열을 변경하지 않고, 새로운 항목을 추가한 새로운 배열을 만든다.
- 불변성을 지키기 위해서이다.
- [React Docs] [성능 최적화](https://ko.reactjs.org/docs/optimizing-performance.html)